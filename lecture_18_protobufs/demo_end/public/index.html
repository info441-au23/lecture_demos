<html>

<head>
  <title>Spies</title>
  <link rel="stylesheet" href="/stylesheets/style.css">
  <script type='text/javascript'>
    async function loadSpies() {
      const response = await fetch('/api/json', {
        headers: {
          'Content-Type': 'application/json'
        },
      });
      const { status, data } = await response.json();

      const rows = data.map(({ name, missions, lastMission }) =>
        `<td>${name}</td><td>${missions}</td><td>${lastMission}</td>`
      );

      document.getElementById('results').innerHTML =
        `<table>
          <thead>
            <tr>
              <th>Name</th>
              <th>Missions</th>
              <th>Last Mission</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              ${rows.join('</tr><tr>')}
            </tr>
          </tbody>
        </table>
      `;
    }
  </script>
</head>

<body>
  <h1>Spies</h1>
  <div>
    <button onclick='loadSpies()'>Load Spies</button>
  </div>
  <div id='results'>
  </div>
</body>

</html>